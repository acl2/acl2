; Primes Library: Group Order Prime for NIST P-256
;
; Copyright (C) 2025 Eric McCarthy (bendyarm on GitHub)
;
; License: See the LICENSE file distributed with this library.

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;; The elliptic curve NIST P-256 (also known as secp256r1 and prime256v1)
;; has a large prime group order.
;; This number is used as the scalar field for ECDSA signature operations.
;; The certificate in this file is used to prove primality of this number.
;; See also the file nist-p-256-base-prime.lisp

;; References for NIST P-256 / secp256r1:
;; * Standards for Efficient Cryptograpy
;;   SEC 2: Recommended Elliptic Curve Domain Parameters
;;   https://www.secg.org/sec2-v2.pdf (Section 2.4.2, p.9)
;; * Standard curve database
;;   https://neuromancer.sk/std/nist/P-256
;; * See also FIPS 186-5
;;   https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf
;; * See also ANSI X9.142-2020 (paywall).

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(in-package "PRIMES")

(include-book "kestrel/number-theory/defprime" :dir :system)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defprime nist-p-256-group-prime

  #xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551

  ;; The following certificate was generated by Cursor (Claude 4 Sonnet)
  ;; using SageMath.

  ;; 115792089210356248762697446949407573529996955224135760342422259061068512044369
  (7 (2 3 71 131 373 3407 17449 38189 187019741 622491383 1002328039319 2624747550333869278416773953)
     (4 1 1 1 1 1 1 1 1 1 1 1)
     (() () () () () () () ()
      ;; 187019741
      (2 (2 5 9350987)
         (2 1 1)
         (() ()
          ;; 9350987
          (2 (2 17 229 1201)
             (1 1 1 1)
             (() () () ()))))
      ;; 622491383
      (5 (2 311245691)
         (1 1)
         (()
          ;; 311245691
          (2 (2 5 7 17 29 311)
             (1 1 1 1 2 1)
             (() () () () () ()))))
      ;; 1002328039319
      (19 (2 126241 3969899)
          (1 1 1)
          (() ()
           ;; 3969899
           (2 (2 19 104471)
              (1 1 1)
              (() () ()))))
      ;; 2624747550333869278416773953
      (7 (2 3 1297 16879 208150935158385979)
         (6 2 1 1 1)
         (() () () ()
          ;; 208150935158385979
          (2 (2 3 11 43 127 3023 191039911)
             (1 1 1 1 1 1 1)
             (() () () () () ()
              ;; 191039911
              (3 (2 3 5 41 155317)
                 (1 1 1 1 1)
                 (() () () () ()))))))))

  :parents (crypto::crypto)

  :short "The NIST P-256 group order prime."

  :long
  (xdoc::topstring
   (xdoc::p
    "The NIST P-256 group order prime is the order of
     the Weierstrass elliptic curve @('NIST P-256'). This prime is used as the
     scalar field for ECDSA signature operations.")
   (xdoc::p
    "The curve @('NIST P-256') is also called @('secp256r1').")
   (xdoc::p
    (xdoc::ahref
     "https://www.secg.org/sec2-v2.pdf"
     "SEC 2: Recommended Elliptic Curve Domain Parameters")
    " (Section 2.4.2) calls it @($n$) and specifies its value in hexadecimal:")
   (xdoc::codeblock
    "0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551")))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; This prime has length 256 bits.

(assert-event (equal (integer-length (nist-p-256-group-prime)) 256))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Decimal version of this prime.

(assert-event
 (equal (nist-p-256-group-prime)
        115792089210356248762697446949407573529996955224135760342422259061068512044369))
